<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‘å¸ƒå‰æµ‹è¯• - Geelato Lite Editor</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .info { background-color: #d1ecf1; color: #0c5460; }
        .editor-container {
            margin: 20px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            min-height: 300px;
        }
        .test-buttons {
            margin: 20px 0;
        }
        .test-buttons button {
            margin: 5px;
            padding: 8px 16px;
            border: 1px solid #007bff;
            background: #007bff;
            color: white;
            border-radius: 4px;
            cursor: pointer;
        }
        .test-buttons button:hover {
            background: #0056b3;
        }
        .debug {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
    <!-- åŠ è½½ç¼–è¾‘å™¨æ ·å¼ -->
    <link rel="stylesheet" href="./dist/lite-editor.css">
</head>
<body>
    <div class="container">
        <h1>ğŸ“ å‘å¸ƒå‰æµ‹è¯•</h1>
        <p>æµ‹è¯•Geelato Lite Editorçš„å®Œæ•´åŠŸèƒ½ï¼Œç¡®ä¿å‘å¸ƒç‰ˆæœ¬æ­£å¸¸å·¥ä½œ</p>
        
        <div id="init-status" class="status info">åˆå§‹åŒ–ä¸­...</div>
        
        <div class="editor-container">
            <div id="editor"></div>
        </div>
        
        <div class="test-buttons">
            <button onclick="testGetContent()">è·å–å†…å®¹</button>
            <button onclick="testSetContent()">è®¾ç½®å†…å®¹</button>
            <button onclick="testClearContent()">æ¸…ç©ºå†…å®¹</button>
            <button onclick="testInsertText()">æ’å…¥æ–‡æœ¬</button>
        </div>
        
        <h3>æµ‹è¯•ç»“æœ</h3>
        <div id="test-results" class="debug">ç­‰å¾…æµ‹è¯•...</div>
        
        <h3>ç¼–è¾‘å™¨å†…å®¹</h3>
        <div id="editor-content" class="debug">ç­‰å¾…è·å–...</div>
    </div>

    <!-- åŠ è½½Vue CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <!-- åŠ è½½æˆ‘ä»¬çš„åº“æ–‡ä»¶ -->
    <script src="./dist/geelato-lite-editor.umd.js"></script>
    
    <script>
        let editorApp = null;
        let editorInstance = null;
        
        // ç­‰å¾…æ‰€æœ‰è„šæœ¬åŠ è½½å®Œæˆ
        window.addEventListener('load', function() {
            const initStatus = document.getElementById('init-status');
            
            try {
                // æ£€æŸ¥ä¾èµ–
                if (typeof Vue === 'undefined') {
                    throw new Error('VueæœªåŠ è½½');
                }
                
                if (typeof GeelatoLiteEditor === 'undefined') {
                    throw new Error('GeelatoLiteEditoræœªåŠ è½½');
                }
                
                console.log('ğŸ“¦ å¯ç”¨çš„å¯¼å‡º:', Object.keys(GeelatoLiteEditor));
                
                // åˆ›å»ºVueåº”ç”¨
                const { createApp } = Vue;
                const { GeelatoLiteEditor: EditorComponent } = GeelatoLiteEditor;
                
                if (!EditorComponent) {
                    throw new Error('æ‰¾ä¸åˆ°GeelatoLiteEditorç»„ä»¶');
                }
                
                console.log('ğŸ¯ ç¼–è¾‘å™¨ç»„ä»¶:', EditorComponent);
                
                // åˆ›å»ºåº”ç”¨
                editorApp = createApp({
                    components: {
                        GeelatoLiteEditor: EditorComponent
                    },
                    data() {
                        return {
                            content: '<p>æ¬¢è¿ä½¿ç”¨Geelato Lite Editorï¼</p><p>è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½æµ‹è¯•é¡µé¢ã€‚</p>',
                            editorOptions: {
                                placeholder: 'è¯·è¾“å…¥å†…å®¹...',
                                editable: true
                            }
                        }
                    },
                    methods: {
                        onEditorCreated(editor) {
                            editorInstance = editor;
                            console.log('âœ… ç¼–è¾‘å™¨å·²å‡†å¤‡å°±ç»ª:', editor);
                            updateContent();
                        },
                        onContentChange(content) {
                            console.log('ğŸ“ å†…å®¹å˜åŒ–:', content);
                            updateContent();
                        }
                    },
                    template: `
                        <geelato-lite-editor
                            v-model:content="content"
                            :options="editorOptions"
                            @created="onEditorCreated"
                            @update:content="onContentChange"
                        />
                    `
                });
                
                // æŒ‚è½½åº”ç”¨
                editorApp.mount('#editor');
                
                initStatus.textContent = 'âœ… ç¼–è¾‘å™¨åˆå§‹åŒ–æˆåŠŸ';
                initStatus.className = 'status success';
                
                // è®°å½•æµ‹è¯•ç»“æœ
                logTest('ç¼–è¾‘å™¨åˆå§‹åŒ–', 'success', 'ç¼–è¾‘å™¨ç»„ä»¶å·²æˆåŠŸæŒ‚è½½');
                
            } catch (error) {
                console.error('âŒ åˆå§‹åŒ–å¤±è´¥:', error);
                initStatus.textContent = `âŒ åˆå§‹åŒ–å¤±è´¥: ${error.message}`;
                initStatus.className = 'status error';
                
                logTest('ç¼–è¾‘å™¨åˆå§‹åŒ–', 'error', error.message);
            }
        });
        
        // æµ‹è¯•å‡½æ•°
        function testGetContent() {
            try {
                if (!editorInstance) {
                    throw new Error('ç¼–è¾‘å™¨æœªåˆå§‹åŒ–');
                }
                
                const content = editorInstance.getHTML();
                console.log('ğŸ“„ è·å–åˆ°çš„å†…å®¹:', content);
                logTest('è·å–å†…å®¹', 'success', `å†…å®¹é•¿åº¦: ${content.length} å­—ç¬¦`);
                updateContent();
            } catch (error) {
                console.error('âŒ è·å–å†…å®¹å¤±è´¥:', error);
                logTest('è·å–å†…å®¹', 'error', error.message);
            }
        }
        
        function testSetContent() {
            try {
                if (!editorInstance) {
                    throw new Error('ç¼–è¾‘å™¨æœªåˆå§‹åŒ–');
                }
                
                const newContent = `
                    <h2>æµ‹è¯•å†…å®¹</h2>
                    <p>è¿™æ˜¯é€šè¿‡ <strong>setContent</strong> æ–¹æ³•è®¾ç½®çš„å†…å®¹ã€‚</p>
                    <ul>
                        <li>åˆ—è¡¨é¡¹ 1</li>
                        <li>åˆ—è¡¨é¡¹ 2</li>
                        <li>åˆ—è¡¨é¡¹ 3</li>
                    </ul>
                    <p>æ—¶é—´æˆ³: ${new Date().toLocaleString()}</p>
                `;
                
                editorInstance.commands.setContent(newContent);
                console.log('âœ… å†…å®¹å·²è®¾ç½®');
                logTest('è®¾ç½®å†…å®¹', 'success', 'æ–°å†…å®¹å·²è®¾ç½®');
                
                setTimeout(updateContent, 100);
            } catch (error) {
                console.error('âŒ è®¾ç½®å†…å®¹å¤±è´¥:', error);
                logTest('è®¾ç½®å†…å®¹', 'error', error.message);
            }
        }
        
        function testClearContent() {
            try {
                if (!editorInstance) {
                    throw new Error('ç¼–è¾‘å™¨æœªåˆå§‹åŒ–');
                }
                
                editorInstance.commands.clearContent();
                console.log('ğŸ—‘ï¸ å†…å®¹å·²æ¸…ç©º');
                logTest('æ¸…ç©ºå†…å®¹', 'success', 'ç¼–è¾‘å™¨å†…å®¹å·²æ¸…ç©º');
                
                setTimeout(updateContent, 100);
            } catch (error) {
                console.error('âŒ æ¸…ç©ºå†…å®¹å¤±è´¥:', error);
                logTest('æ¸…ç©ºå†…å®¹', 'error', error.message);
            }
        }
        
        function testInsertText() {
            try {
                if (!editorInstance) {
                    throw new Error('ç¼–è¾‘å™¨æœªåˆå§‹åŒ–');
                }
                
                const text = `æ’å…¥çš„æ–‡æœ¬ - ${new Date().toLocaleTimeString()}`;
                editorInstance.commands.insertContent(text);
                console.log('ğŸ“ æ–‡æœ¬å·²æ’å…¥:', text);
                logTest('æ’å…¥æ–‡æœ¬', 'success', `å·²æ’å…¥: ${text}`);
                
                setTimeout(updateContent, 100);
            } catch (error) {
                console.error('âŒ æ’å…¥æ–‡æœ¬å¤±è´¥:', error);
                logTest('æ’å…¥æ–‡æœ¬', 'error', error.message);
            }
        }
        
        // è¾…åŠ©å‡½æ•°
        function logTest(testName, status, details) {
            const results = document.getElementById('test-results');
            const timestamp = new Date().toLocaleTimeString();
            const statusIcon = status === 'success' ? 'âœ…' : 'âŒ';
            const log = `[${timestamp}] ${statusIcon} ${testName}: ${details}\n`;
            results.textContent += log;
            results.scrollTop = results.scrollHeight;
        }
        
        function updateContent() {
            try {
                if (editorInstance) {
                    const content = editorInstance.getHTML();
                    document.getElementById('editor-content').textContent = content;
                }
            } catch (error) {
                console.error('æ›´æ–°å†…å®¹æ˜¾ç¤ºå¤±è´¥:', error);
            }
        }
    </script>
</body>
</html>